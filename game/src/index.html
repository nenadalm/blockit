
<!DOCTYPE html>
<html>
  <head>
    <script src="./htmx.js"></script>
    <!-- <script src="./game.js"></script> -->
    <!-- <link rel="stylesheet" href="style.css" /> -->
    <title>Gmae</title>
  </head>
  <body>

    <header>
      <h1>Gaem</h1>
      <form hx-post="api/hiscore" id="score-form" name="score form">
        <input name="name" type="name" autocomplete="name" required />
        <input name="score" type="number" required id="score" />
        <button type="submit" value>submit</button>
      </form>
      <!-- <button hx-get="hiscores" hx-target="#hiscores-section" hx-swap="innerHTML">Hiscores</button> -->
    </header>

    <!-- <section id="hiscores-section">
    </section> -->

    <section id="game" style="height: 80vh">
      <button
        hx-get="game.js"
        hx-trigger="click"
        hx-swap="none"
        hx-on="htmx:afterRequest: this.remove(); runFetchedScript(this);"
      >load game</button>
    </section>

    <script>
        function runFetchedScript(button) {
            // Find the fetched script content
            fetch(button.getAttribute('hx-get'))
                .then(response => response.text())
                .then(scriptContent => {
                    // Create a new script element
                    const scriptElement = document.createElement('script');
                    scriptElement.textContent = scriptContent;
                    // Append the script to the body so that it executes
                    document.body.appendChild(scriptElement);

                    // Optionally remove the button after the script is loaded
                    button.remove();
                })
                .catch(error => console.error('Error loading script:', error));
        }
    </script>

  </body>
</html>